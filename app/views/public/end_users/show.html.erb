<%= image_tag @end_user.get_profile_image(200,200) %><br>
<%= @end_user.name %> :: @<%= @end_user.screen_name %><br>
<%= @end_user.era %><%= @end_user.gender_i18n %>
<%= link_to "編集する", end_user_edit_path, class: "btn btn-danger btn-block" %>
<hr>



<% if @reviews.present? %>

  <div style="position:relative; width:250px; height:250px;">
    <canvas id="MyReviewChart"></canvas>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    const ctx = document.getElementById('MyReviewChart');

    new Chart(ctx, {
      type: 'pie',
      data: {
        labels: <%= @chartlabels %>,
        datasets: [{
          data: [
            <% @categorys.each do |category| %>
              <%= Review.where(category: category, end_user_id: @end_user.id ).count.to_i %>,
            <% end %>
            ],
          borderWidth: 1
        }]
      },
      options: {
        plugins: {
            legend: false
        },
    }
    });
  </script>

  <% @categorys.each do |category| %>
    <%= category %>
    <%= @count = Review.where(category: category, end_user_id: @end_user.id ).count %>件
    <br>
  <% end %>
  <hr>
<% else %>
  <div>
    <h4>
      ようこそ、<%= @end_user.name %>さん！
      さっそく商品を検索してレビューしていきましょう！
    </h4>
  </div>
<% end %>



<% if @favorites.present? %>
  <h2 style="background-color:#cccccc"><%= @end_user.name %>さんの欲しい物</h2>
  <%= @end_user.favorites_introduction %>
  <hr>
  <% @favorites.each do |favorite| %>
    <%= image_tag (favorite.image) %>
    <%= favorite.name %>
    <%= favorite.price %><br>
    <hr>
  <% end %>
  <%= link_to end_user_favorites_path(@end_user.screen_name) do %>
    一覧
  <% end %>
<% elsif current_end_user.screen_name == params[:screen_name] %>
  <h2 style="background-color:#cccccc"><%= @end_user.name %>さんの欲しい物</h2>
  <%= @end_user.favorites_introduction %>
  <div>
    <p>まだ商品はありません！</p>
  </div>
<% elsif @end_user.favorites_introduction != "" %>
  <h2 style="background-color:#cccccc"><%= @end_user.name %>さんの欲しい物</h2>
  <%= @end_user.favorites_introduction %>
<% end %>




<% if @want_items.present? %>
  <h2 style="background-color:#cccccc"><%= @end_user.name %>さんの好きな物</h2>
  <%= @end_user.want_items_introduction %>
  <% @want_items.each do |want_item| %>
    <%= image_tag (want_item.image) %>
    <%= want_item.name %>
    <%= want_item.price %>
    <hr>
  <% end %>
  <%= link_to end_user_want_items_path(@end_user.screen_name) do %>
    一覧
  <% end %>
<% elsif current_end_user.screen_name == params[:screen_name] %>
  <h2 style="background-color:#cccccc"><%= @end_user.name %>さんの好きな物</h2>
  <%= @end_user.want_items_introduction %>
  <div>
    <p>まだ商品はありません！</p>
  </div>
<% elsif @end_user.want_items_introduction != "" %>
  <h2 style="background-color:#cccccc"><%= @end_user.name %>さんの好きな物</h2>
  <%= @end_user.want_items_introduction %>
<% end %>





<% if @reviews.present? %>
<h2 style="background-color:#cccccc"><%= @end_user.name %>さんのレビュー</h2>
  <% @reviews.first(1).each do |review| %>
    <%= image_tag (review.image) %>
    <%= review.name %>
    <%= review.price %>
    <%= review.body %>
    <%= review.created_at.strftime('%Y/%m/%d') %>
    <hr>
  <% end %>
  <%= link_to end_user_reviews_path(@end_user.screen_name) do %>
    一覧
  <% end %>
<% elsif current_end_user.screen_name == params[:screen_name] %>
  <h2 style="background-color:#cccccc"><%= @end_user.name %>さんのレビュー</h2>
  <div>
    <p>まだ商品はありません！</p>
  </div>
<% end %>